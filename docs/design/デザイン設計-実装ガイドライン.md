## 7. 実装ガイドライン

### 7.1 技術スタック

- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS v4
- **UI Components**: shadcn/ui
- **State Management**: Zustand
- **Form**: React Hook Form + Zod
- **API Communication**: Fetch API / Axios
- **Real-time**: Socket.io Client

### 7.2 ディレクトリ構造（推奨）

```
frontend/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── (auth)/             # 認証グループ
│   │   │   ├── login/
│   │   │   └── register/
│   │   ├── (client)/           # 利用者グループ
│   │   │   ├── dashboard/
│   │   │   ├── services/
│   │   │   ├── messages/
│   │   │   └── bookings/
│   │   ├── (sponsor)/          # パートナーグループ
│   │   │   ├── dashboard/
│   │   │   ├── services/
│   │   │   └── bookings/
│   │   ├── layout.tsx          # ルートレイアウト
│   │   └── page.tsx            # トップページ
│   ├── components/             # 共通コンポーネント
│   │   ├── ui/                 # shadcn/ui コンポーネント
│   │   ├── layout/             # レイアウトコンポーネント
│   │   │   ├── Header.tsx
│   │   │   ├── Footer.tsx
│   │   │   ├── Sidebar.tsx
│   │   │   └── Navigation.tsx
│   │   ├── service/            # サービス関連
│   │   │   ├── ServiceCard.tsx
│   │   │   ├── ServiceList.tsx
│   │   │   └── ServiceFilter.tsx
│   │   ├── message/            # メッセージ関連
│   │   │   ├── MessageList.tsx
│   │   │   ├── ChatWindow.tsx
│   │   │   └── MessageInput.tsx
│   │   └── common/             # 汎用コンポーネント
│   │       ├── Avatar.tsx
│   │       ├── Badge.tsx
│   │       └── EmptyState.tsx
│   ├── lib/                    # ユーティリティ
│   │   ├── api.ts              # APIクライアント
│   │   ├── utils.ts            # 汎用関数
│   │   └── validations.ts      # Zodスキーマ
│   ├── hooks/                  # カスタムフック
│   │   ├── useAuth.ts
│   │   ├── useSocket.ts
│   │   └── useServices.ts
│   ├── stores/                 # Zustand ストア
│   │   ├── authStore.ts
│   │   ├── messageStore.ts
│   │   └── bookingStore.ts
│   ├── types/                  # TypeScript型定義
│   │   ├── user.ts
│   │   ├── service.ts
│   │   ├── booking.ts
│   │   └── message.ts
│   └── styles/                 # グローバルスタイル
│       └── globals.css
├── public/                     # 静的ファイル
│   ├── images/
│   └── icons/
└── package.json
```

### 7.3 コーディング規約

#### コンポーネント命名

```tsx
// ファイル名: PascalCase
// ServiceCard.tsx

// コンポーネント名: PascalCase
export const ServiceCard: React.FC<ServiceCardProps> = ({ service }) => {
  // ...
}
```

#### Props定義

```tsx
// インターフェース定義
interface ServiceCardProps {
  service: Service;
  onClick?: (id: string) => void;
  className?: string;
}

// デフォルトProps
const ServiceCard: React.FC<ServiceCardProps> = ({
  service,
  onClick,
  className = ""
}) => {
  // ...
}
```

#### Tailwind CSS クラス整理

```tsx
// cn() ユーティリティを使用
import { cn } from "@/lib/utils";

<div className={cn(
  "rounded-lg border bg-card p-6 shadow-sm",
  "hover:shadow-md transition-shadow",
  className
)}>
  {/* ... */}
</div>
```

#### ステート管理（Zustand）

```tsx
// stores/authStore.ts
import { create } from 'zustand';

interface AuthState {
  user: User | null;
  isAuthenticated: boolean;
  login: (user: User) => void;
  logout: () => void;
}

export const useAuthStore = create<AuthState>((set) => ({
  user: null,
  isAuthenticated: false,
  login: (user) => set({ user, isAuthenticated: true }),
  logout: () => set({ user: null, isAuthenticated: false }),
}));
```

#### フォームバリデーション（Zod）

```tsx
import { z } from "zod";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";

const loginSchema = z.object({
  email: z.string().email("有効なメールアドレスを入力してください"),
  password: z.string().min(8, "パスワードは8文字以上である必要があります"),
});

type LoginFormData = z.infer<typeof loginSchema>;

const LoginForm = () => {
  const form = useForm<LoginFormData>({
    resolver: zodResolver(loginSchema),
  });

  // ...
}
```

### 7.4 アクセシビリティ

#### キーボード操作

- Tab: フォーカス移動
- Enter/Space: ボタン・リンク実行
- Esc: モーダル・ドロップダウン閉じる
- Arrow keys: リスト・メニュー内移動

#### セマンティックHTML

```tsx
// Good
<button onClick={handleClick}>送信</button>
<nav>...</nav>
<main>...</main>

// Bad
<div onClick={handleClick}>送信</div>
```

#### ARIAラベル

```tsx
<button aria-label="メニューを開く">
  <MenuIcon />
</button>

<input
  type="search"
  aria-label="サービスを検索"
  placeholder="キーワード..."
/>
```

### 7.5 パフォーマンス最適化

#### 画像最適化

```tsx
import Image from 'next/image';

<Image
  src="/images/service.jpg"
  alt="サービス画像"
  width={400}
  height={300}
  loading="lazy"
  placeholder="blur"
/>
```

#### 動的インポート

```tsx
import dynamic from 'next/dynamic';

const ChatWindow = dynamic(() => import('@/components/message/ChatWindow'), {
  loading: () => <Skeleton />,
  ssr: false,
});
```

#### メモ化

```tsx
import { useMemo, useCallback } from 'react';

const ServiceList = ({ services }) => {
  const filteredServices = useMemo(() => {
    return services.filter(/* ... */);
  }, [services]);

  const handleClick = useCallback((id: string) => {
    // ...
  }, []);

  return <div>{/* ... */}</div>;
}
```

---

## 付録
